<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Leave Request Management ‚Äì EcoTrack</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

  <style>
    :root {
      --bg-gradient: linear-gradient(to right, #0f2027, #2c5364);
      --container-gradient: linear-gradient(to right, #232526, #1e3c72);
      --primary: #1976d2;
      --secondary: #0d47a1;
      --highlight: #4fc3f7;
      --light-blue: #90caf9;
      --text-light: #f0f0f0;
      --shadow: rgba(31, 38, 135, 0.37);
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: var(--bg-gradient);
      color: var(--text-light);
    }

    .container { display: flex; min-height: 100vh; }

    .status-badge {
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 13px;
  font-weight: 600;
  display: inline-block;
  text-align: center;
  min-width: 70px;
}

/* Status Colors */
.status-pending { background-color: orange; color: #fff; }
.status-approved { background-color: limegreen; color: #fff; }
.status-rejected { background-color: #ff5252; color: #fff; }

    /* Sidebar */
    .sidebar { width: 260px; background: var(--container-gradient); transition: width 0.3s ease; overflow: hidden; position: relative; }
    .sidebar.collapsed { width: 70px; }
    .sidebar h2 { text-align: center; padding: 20px 0; font-size: 1.6rem; margin: 0; transition: opacity 0.3s; }
    .sidebar.collapsed h2 { opacity: 0; }
    .sidebar ul { list-style: none; padding: 0; margin: 0; }
    .sidebar ul li { padding: 16px 24px; display: flex; align-items: center; gap: 12px; cursor: pointer; transition: background 0.3s ease; }
    .sidebar ul li:hover { background-color: rgba(255, 255, 255, 0.08); }
    .sidebar ul li i { font-size: 18px; }
    .sidebar ul li a { display: flex; align-items: center; gap: 12px; color: var(--text-light); text-decoration: none; width: 100%; height: 100%; }
    .sidebar ul li span { transition: opacity 0.3s ease; }
    .sidebar.collapsed ul li span { opacity: 0; }
    .toggle-btn { position: absolute; top: 12px; right: 12px; background: none; border: none; font-size: 22px; color: var(--text-light); cursor: pointer; }

    /* Main Content */
    .main { flex: 1; padding: 24px; transition: margin-left 0.3s ease; }
    .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; }
    .header h1 { font-size: 24px; }

    /* Table */
    table { width: 100%; border-collapse: collapse; background-color: #1c2b4a; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px var(--shadow); }
    th, td { padding: 16px; text-align: left; border-bottom: 1px solid #33415c; }
    th { background-color: #273b61; color: var(--highlight); }
    tr:hover { background-color: rgba(255, 255, 255, 0.03); }

    .actions { display: flex; gap: 10px; }
    .action-btn { background: none; border: none; cursor: pointer; font-size: 18px; color: var(--light-blue); transition: all 0.2s ease-in-out; }
    .action-btn:hover { color: var(--highlight); transform: scale(1.1); }

    /* Modal */
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background: rgba(15,32,39,0.9); backdrop-filter: blur(5px); }
    .modal-content { background: #1c2b4a; margin: 8% auto; padding: 30px; border-radius: 12px; width: 90%; max-width: 500px; box-shadow: 0 4px 12px var(--shadow); color: var(--text-light); position: relative; }
    .close-btn { position: absolute; top: 12px; right: 16px; font-size: 28px; font-weight: bold; cursor: pointer; color: var(--highlight); transition: color 0.3s ease; }
    .close-btn:hover { color: var(--light-blue); }
    .modal-content h2 { margin-top: 0; color: var(--highlight); }
    .form-group { margin-bottom: 16px; }
    .form-group label { display: block; margin-bottom: 6px; color: var(--light-blue); }
    .form-group textarea { width: 100%; padding: 10px; border-radius: 6px; border: none; background-color: #273b61; color: var(--text-light); }
    .submit-btn { padding: 10px 18px; background-color: var(--primary); border: none; color: white; border-radius: 6px; cursor: pointer; font-size: 14px; transition: background 0.3s ease; }
    .submit-btn:hover { background-color: var(--secondary); }

    @media screen and (max-width: 768px) {
      .sidebar { position: fixed; z-index: 999; height: 100%; }
      .main { margin-left: 70px; }
      .sidebar.collapsed + .main { margin-left: 70px; }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="sidebar" id="sidebar">
      <button class="toggle-btn" onclick="toggleSidebar()"><i class="bi bi-list"></i></button>
      <h2>EcoTrack</h2>
      <ul>
        <li><a href="{% url 'admin_dashboard' %}"><i>üè†</i> <span>Dashboard</span></a></li>
        <li><a href="{% url 'pickup_management' %}"><i>üóëÔ∏è</i> <span>Pickup Management</span></a></li>
        <li><a href="{% url 'zone_management' %}"><i>üìç</i> <span>Zone Management</span></a></li>
        <li><a href="{% url 'leave_req_management' %}"><i>üìÖ</i> <span>Leave Requests</span></a></li>
        <li><a href="{% url 'complaint_management' %}"><i>üì¢</i> <span>Complaints</span></a></li>
        <li><a href="{% url 'user_management' %}"><i>üßë‚Äçü§ù‚Äçüßë</i> <span>User Management</span></a></li>
        <li><a href="{% url 'collector_management' %}"><i>üë∑‚Äç‚ôÇÔ∏è</i> <span>Collector Management</span></a></li>
        <li><a href="{% url 'analytics' %}"><i>üìä</i> <span>Analytics</span></a></li>
        <li><a href="{% url 'admin_profile' %}"><i>üë§</i> <span>Admin Profile</span></a></li>
      </ul>
    </div>

    <div class="main">
      <div class="header">
        <h1>Collector Leave Requests</h1>
      </div>

      <table>
        <thead>
          <tr>
            <th>Collector</th>
            <th>From</th>
            <th>To</th>
            <th>Reason</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for leave in leaves %}
          <tr>
            <td>{{ leave.collector }}</td>
            <td>{{ leave.start_date }}</td>
            <td>{{ leave.end_date }}</td>
            <td>{{ leave.reason }}</td>
            <td>
  <span class="status-badge
    {% if leave.status == 'Approved' %}status-approved
    {% elif leave.status == 'Rejected' %}status-rejected
    {% else %}status-pending{% endif %}">
    {{ leave.status }}
  </span>
</td>

            <td class="actions">
              {% if leave.status != 'Approved' %}
              <button class="action-btn" title="Approve" onclick="openModal('{{ leave.id }}','Approve')"><i class="bi bi-check-circle-fill"></i></button>
              {% endif %}
              {% if leave.status != 'Rejected' %}
              <button class="action-btn" title="Reject" onclick="openModal('{{ leave.id }}','Reject')"><i class="bi bi-x-circle-fill"></i></button>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal -->
  <div id="actionModal" class="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle">Confirm Action</h2>
      <form method="POST" action="#">
        {% csrf_token %}
        <input type="hidden" name="leave_id" id="modalLeaveId">
        <input type="hidden" name="action" id="modalAction">
        <div class="form-group">
          <label for="note">Note (Optional)</label>
          <textarea name="note" id="modalNote" rows="3" placeholder="Add any remarks..."></textarea>
        </div>
        <button type="submit" class="submit-btn">Submit</button>
      </form>
    </div>
  </div>

  <script>
    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('collapsed');
    }

    const modal = document.getElementById('actionModal');
    const modalLeaveId = document.getElementById('modalLeaveId');
    const modalAction = document.getElementById('modalAction');
    const modalTitle = document.getElementById('modalTitle');
    const modalNote = document.getElementById('modalNote');

    function openModal(leaveId, actionType) {
      modal.style.display = 'block';
      modalLeaveId.value = leaveId;
      modalAction.value = actionType;
      modalTitle.textContent = `${actionType} Leave Request`;
      modalNote.value = '';
    }

    function closeModal() {
      modal.style.display = 'none';
    }

    window.onclick = function(event) {
      if (event.target == modal) { modal.style.display = 'none'; }
    }
  </script>
</body>
</html>
